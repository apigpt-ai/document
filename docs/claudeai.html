
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta
            name="description"
            content="Documentation for APIGPT.CLOUD ClaudeAI API"
        >
    <title>APIGPT.CLOUD - ClaudeAI 开发文档</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-bbbf83f5.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-88f539c5.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-b12a2749.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="claudeai" data-languages="[&quot;shell&quot;,&quot;python&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-b7be038d.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="python">python</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#apigpt-cloud-claudeai" class="toc-h1 toc-link" data-title="APIGPT.Cloud - ClaudeAI 开发文档">APIGPT.Cloud - ClaudeAI 开发文档</a>
          </li>
          <li>
            <a href="#01" class="toc-h1 toc-link" data-title="01 提示格式化">01 提示格式化</a>
          </li>
          <li>
            <a href="#02" class="toc-h1 toc-link" data-title="02 客户端库">02 客户端库</a>
          </li>
          <li>
            <a href="#03" class="toc-h1 toc-link" data-title="03 流式传输">03 流式传输</a>
          </li>
          <li>
            <a href="#04" class="toc-h1 toc-link" data-title="04 事件">04 事件</a>
          </li>
          <li>
            <a href="#05" class="toc-h1 toc-link" data-title="05 模型">05 模型</a>
          </li>
          <li>
            <a href="#06-completions-api" class="toc-h1 toc-link" data-title="06 Completions API">06 Completions API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#api-create-a-completion" class="toc-h2 toc-link" data-title="API - Create a completion">API - Create a completion</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#cf68bca02a" class="toc-h1 toc-link" data-title="错误代码">错误代码</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><center><a href='index.html'>返回文档首页</a></center></li>
        </ul>

      <div style="padding:60px">

      <!--<img src="images/qrcode_for_apigpt-723fccb3.jpg" class="logo" alt="" />
      <p style="color:grey">扫描关注<br />生成式AI云公众号</p>

      <img src="images/apigpt-contact-e412e752.png" class="logo" alt="" />
      <p style="color:grey">扫描加入<br />生成式AI用户群</p>-->
      </div>

    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='apigpt-cloud-claudeai'>APIGPT.Cloud - ClaudeAI 开发文档</h1>
<p>该 API 可通过我们的沙盒平台提供。这使您有机会在开始技术集成之前评估 Claude 的能力。</p>
<h1 id='01'>01 提示格式化</h1>
<p>默认情况下，我们的沙盒将正确处理类似“天空为什么是蓝色的？”这样的直接问题。然而，当使用API时，您必须按照以下格式设置提示：</p>

<p><code>\n\nHuman: Why is the sky blue?\n\nAssistant:</code></p>

<p>请注意每个冒号后面的两个换行符和一个空格，除了最后一个冒号。例如，在代码中使用它：</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">userQuestion</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Why is the sky blue?</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">prompt</span> <span class="o">=</span> <span class="s2">`\n\nHuman: </span><span class="p">${</span><span class="nx">userQuestion</span><span class="p">}</span><span class="s2">\n\nAssistant:`</span><span class="p">;</span>

<span class="c1">// Send prompt to Claude via API</span>

</code></pre></div><h1 id='02'>02 客户端库</h1>
<p>我们提供了Python和Typescript（即将推出）的客户端库，使得使用API更加便捷。</p>

<p>Python 库: <code>https://github.com/apigptcloud/anthropic-sdk-python</code></p>
<div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">anthropic</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">anthropic</span><span class="p">.</span><span class="n">Client</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'ANTHROPIC_API_KEY'</span><span class="p">])</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">completion</span><span class="p">(</span>
    <span class="n">prompt</span><span class="o">=</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">anthropic</span><span class="p">.</span><span class="n">HUMAN_PROMPT</span><span class="si">}</span><span class="s"> How many toes do dogs have?</span><span class="si">{</span><span class="n">anthropic</span><span class="p">.</span><span class="n">AI_PROMPT</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="s">"claude-1"</span><span class="p">,</span>
    <span class="n">max_tokens_to_sample</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div>
<p>Typescript 库: <code>https://github.com/apigptcloud/anthropic-sdk-typescript</code></p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">import</span> <span class="dl">"</span><span class="s2">dotenv/config</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AI_PROMPT</span><span class="p">,</span> <span class="nx">Client</span><span class="p">,</span> <span class="nx">HUMAN_PROMPT</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@anthropic-ai/sdk</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">ANTHROPIC_API_KEY</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">apiKey</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">The ANTHROPIC_API_KEY environment variable must be set</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">);</span>
<span class="nx">client</span>
  <span class="p">.</span><span class="nx">complete</span><span class="p">({</span>
    <span class="na">prompt</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">HUMAN_PROMPT</span><span class="p">}</span><span class="s2"> How many toes do dogs have?</span><span class="p">${</span><span class="nx">AI_PROMPT</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
    <span class="na">max_tokens_to_sample</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="na">model</span><span class="p">:</span> <span class="dl">"</span><span class="s2">claude-1</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">finalSample</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">finalSample</span><span class="p">.</span><span class="nx">completion</span><span class="p">);</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre></div><h1 id='03'>03 流式传输</h1>
<p>在进行API请求时，您可以设置&quot;stream&quot;: true，以使用服务器发送事件(SSE)逐步流式传输响应。如果您使用我们的客户端库，则这些事件的解析将自动处理。但是，如果您正在构建直接的API集成，您需要自己处理这些事件。</p>

<blockquote>
<p>流式示范请求</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--request</span> POST <span class="se">\</span>
     <span class="nt">--url</span> https://claude.pgpt.cloud/v1/complete <span class="se">\</span>
     <span class="nt">--header</span> <span class="s2">"content-type: application/json"</span> <span class="se">\</span>
     <span class="nt">--header</span> <span class="s2">"x-api-key: </span><span class="nv">$API_KEY</span><span class="s2">"</span> <span class="se">\</span>
     <span class="nt">--data</span> <span class="s1">'
{
  "model": "claude-1",
  "prompt": "\n\nHuman: Hello, world!\n\nAssistant:",
  "max_tokens_to_sample": 256,
  "stream": true
}
'</span>
</code></pre></div>
<blockquote>
<p>流式示范请求返回</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>event: completion
data: {"completion": " Hello", "stop_reason": null, "model": "claude-1.3"}

event: completion
data: {"completion": "!", "stop_reason": null, "model": "claude-1.3"}

event: ping
data: {}

event: completion
data: {"completion": " My", "stop_reason": null, "model": "claude-1.3"}

event: completion
data: {"completion": " name", "stop_reason": null, "model": "claude-1.3"}

event: completion
data: {"completion": " is", "stop_reason": null, "model": "claude-1.3"}

event: completion
data: {"completion": " Claude", "stop_reason": null, "model": "claude-1.3"}

event: completion
data: {"completion": ".", "stop_reason": null, "model": "claude-1.3"}

event: completion
data: {"completion": "", "stop_reason": "stop_sequence", "model": "claude-1.3"}

</code></pre></div><h1 id='04'>04 事件</h1>
<p>每个事件都包括一个命名的事件类型和相关的JSON数据。</p>

<aside class="notice">
`处理未知的事件类型`
目前我们发送完成、ping和错误事件类型，但是这个列表可能会随着时间的推移而扩展，您的集成必须忽略任何意外的事件类型。
</aside>

<p>我们可能会偶尔在事件流中发送错误。例如，在高使用期间，您可能会收到一个overloaded_error，这通常对应于非流式上下文中的HTTP 529:</p>
<div class="highlight"><pre class="highlight plaintext"><code>event: completion
data: {"completion": " Hello", "stop_reason": null, "model": "claude-1.3"}

event: error
data: {"error": {"type": "overloaded_error", "message": "Overloaded"}}
</code></pre></div><h1 id='05'>05 模型</h1>
<p>我们目前提供两个模型系列，两者都支持10万个标记的上下文窗口：</p>

<ul>
<li>Claude-instant：低延迟，高吞吐量</li>
<li>Claude：在需要复杂推理的任务中表现出色</li>
</ul>

<p>在向我们的 Completions API 发送请求时，您必须使用模型参数指定要执行完成的模型。我们建议您指定最新的主要版本，这样您将在发布更新时自动获得模型的更新。或者，如果您依赖于精确的输出形状，您可以指定完整的模型版本。</p>

<p>有关模型更多详细信息，请参见<a href='/index.html#apigpt-claudeai'>模型</a>。</p>
<h1 id='06-completions-api'>06 Completions API</h1>
<p>ClaudeAI 目前只有一个补全API</p>
<h2 id='api-create-a-completion'>API - Create a completion</h2>
<p><code>POST https://claude.pgpt.cloud/v1/complete</code></p>

<p>创建一个补全</p>
<h3 id='request-body'>Request body</h3><h4 id='model-string-required'>参数 - model <code>string</code> Required</h4>
<p>将会完成您的提示的模型。</p>

<p>随着我们改进 Claude，我们会开发新的版本供您查询。这个参数控制着 Claude 回答您请求的版本。目前我们提供两个模型系列：Claude 和 Claude-instant。您可以通过将模型设置为“claude-2”或“claude-instant-1”来使用它们。有关更多详细信息，请参见<a href='/index.html#apigpt-claudeai'>模型</a>。</p>
<h4 id='prompt-blob-required'>参数 - prompt <code>blob</code> Required</h4>
<p>您想让Claude完成的提示。</p>

<p>为了生成适当的响应，您需要按照以下格式设置您的提示，就像我们在上面提示格式化章节介绍的一样：</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">userQuestion</span> <span class="o">=</span> <span class="nx">r</span><span class="dl">"</span><span class="s2">Why is the sky blue?</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">prompt</span> <span class="o">=</span> <span class="s2">`\n\nHuman: </span><span class="p">${</span><span class="nx">userQuestion</span><span class="p">}</span><span class="s2">\n\nAssistant:`</span><span class="p">;</span>
</code></pre></div><h4 id='max_tokens_to_sample-integer-required'>参数 - max_tokens_to_sample <code>integer</code> required</h4>
<p>在停止生成之前生成的最大标记数。</p>

<p>请注意，我们的模型可能在达到此最大值之前就停止。此参数仅指定要生成的绝对最大标记数。</p>
<h4 id='stop_sequences-array-of-strings'>参数 - stop_sequences <code>array of strings</code></h4>
<p>会导致模型停止生成完整文本的序列。</p>

<p>我们的模型会在&quot;\n\nHuman:&quot;处停止，将来可能会包括其他内置的停止序列。通过提供stop_sequences参数，您可以包括其他字符串，这些字符串将导致模型停止生成。</p>
<h4 id='temperature-number'>参数 - temperature <code>number</code></h4>
<p>注入响应中的随机性量。</p>

<p>默认为1。范围从0到1。将temp设置得更接近0可用于分析/多选题，而将其设置得更接近1可用于创造性和生成性任务。</p>
<h4 id='top_p-number'>参数 - top_p <code>number</code></h4>
<p>使用核心采样。</p>

<p>在核心采样中，我们按减少的概率顺序计算每个后续标记的所有选项的累积分布，并在达到由top_p指定的特定概率时将其截断。您应该更改温度或top_p，但不能两者同时更改。</p>
<h4 id='top_k-integer'>参数 - top_k <code>integer</code></h4>
<p>只从每个后续标记的前K个选项中进行采样。</p>

<p>用于删除“长尾”低概率响应。在此处了解更多技术细节。</p>
<h4 id='metadata-object'>参数 - metadata <code>object</code></h4>
<p>描述请求元数据的对象。</p>

<p>user_id字符串
与请求相关联的用户的外部标识符。</p>

<p>这应该是uuid、哈希值或其他不透明标识符。Anthropic可能使用此id来帮助检测滥用行为。不要包括任何识别信息，例如姓名、电子邮件地址或电话号码。</p>
<h4 id='stream-boolean'>参数 - stream <code>boolean</code></h4>
<p>是否使用服务器发送事件逐步流式传输响应，见上面流式传输章节。</p>
<h1 id='cf68bca02a'>错误代码</h1>
<aside class="notice">
APIGPT APIs 使用下列的错误代码
</aside>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Invalid request: there was an issue with the format or content of your request.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized: there&#39;s an issue with your API key.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden: your API key does not have permission to use the specified resource.</td>
</tr>
<tr>
<td>404</td>
<td>Not found: the requested resource was not found.</td>
</tr>
<tr>
<td>429</td>
<td>Your account has hit a rate limit.</td>
</tr>
<tr>
<td>500</td>
<td>An unexpected error has occurred internal to Anthropic&#39;s systems.</td>
</tr>
<tr>
<td>529</td>
<td>Your API is temporarily overloaded.</td>
</tr>
</tbody></table>

<p>When receiving a streaming response via SSE, it&#39;s possible that an error can occur after returning a 200 response, in which case error handling wouldn&#39;t follow these standard mechanisms.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="python">python</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
